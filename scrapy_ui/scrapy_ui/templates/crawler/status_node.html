{% extends "base.html" %}
{% load static i18n %}

{% block title %} {{ status.node_name }} | Scrapy UI {% endblock %}

{% block content %}

    <div class="row tile_count">

        <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
            <div class="tile-stats">
                <div class="icon"><i class="fa fa-cogs"></i>
                </div>
                <div class="count text-info" style="text-transform: uppercase;">{{ status.status }}</div>
                <h3>Spider Status</h3>
                <!--<p>Lorem ipsum psdea itgum rixt.</p>-->
            </div>
        </div>

        <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
            <div class="tile-stats">
                <div class="icon"><i class="fa fa-pause"></i>
                </div>
                <div class="count text-info" style="text-transform: uppercase;">{{ status.pending }}</div>
                <h3>Pending Jobs</h3>
                <!--<p>Lorem ipsum psdea itgum rixt.</p>-->
            </div>
        </div>

        <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
            <div class="tile-stats">
                <div class="icon"><i class="fa fa-play"></i>
                </div>
                <div class="count text-info" style="text-transform: uppercase;">{{ status.running }}</div>
                <h3>Running Jobs</h3>
                <!--<p>Lorem ipsum psdea itgum rixt.</p>-->
            </div>
        </div>

        <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
            <div class="tile-stats">
                <div class="icon"><i class="fa fa-stop"></i>
                </div>
                <div class="count text-info" style="text-transform: uppercase;">{{ status.finished }}</div>
                <h3>Finished Jobs</h3>
                <!--<p>Lorem ipsum psdea itgum rixt.</p>-->
            </div>
        </div>

    </div>



    <div class="sui-box">
        <h3 class="title">Spider</h3>
        <table class="table ">
            <thead class="thead-light">
            <tr>
                <th>Spider name</th>
                <th width="10%">Run Now</th>
            </tr>
            </thead>
            <tbody>
            {% for spider in spiders %}
                <tr>
                    <td><span class="badge badge-info spider-name">{{ spider }}</span></td>
                    <td><a class="btn btn-info" href=""><i
                            class="fa fa-play"></i> Run</a></td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="sui-box">
        <h3 class="title">Running Jobs</h3>
        <table class="table">
            <thead class="thead-light">
            <tr>
                <th>ID</th>
                <th>Spider name</th>
                <th>Pid</th>
                <th>Start time</th>
                <th>Logs</th>
            </tr>
            </thead>
            <tbody>
            {% if not jobs.running %}
                <tr><td class="no-table-data">No running jobs</td></tr>
            {% endif %}
            {% for job in jobs.running %}
                <tr>
                    <td>{{ job.id }}</td>
                    <td><span class="badge badge-info spider-name">{{ job.spider }}</span></td>
                    <td>{{ job.pid }}</td>
                    <td class="mm-time" data-utc="{{ job.start_time }}">{{ job.start_time }}</td>
                    <td><a target="_blank" href="{{ log_url }}/{{ job.spider }}/{{ job.id }}.log">Logs</a></td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="sui-box">
        <h3 class="title">Pending Jobs</h3>
        <table class="table">
            <thead class="thead-light">
            <tr>
                <th>ID</th>
                <th>Spider name</th>
                <th>Logs</th>
            </tr>
            </thead>
            <tbody>
            {% if not jobs.pending %}
                <tr><td class="no-table-data">No pending jobs </td></tr>
            {% endif %}
            {% for job in jobs.pending %}
                <tr>
                    <td>{{ job.id }}</td>
                    <td><span class="badge badge-info spider-name">{{ job.spider }}</span></td>
                    <td><a target="_blank" href="{{ log_url }}/{{ job.spider }}/{{ job.id }}.log">Logs</a></td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>


    <div class="sui-box">
        <h3 class="title">Finished Jobs</h3>
        <table class="table">
            <thead class="thead-light">
            <tr>
                <th>ID</th>
                <th>Spider name</th>
                <th>Start time</th>
                <th>End time</th>
                <th>During (minutes)</th>
                <th>Logs</th>
            </tr>
            </thead>
            <tbody>
            {% if not jobs.finished %}
                <tr><td class="no-table-data">No finished jobs </td></tr>
            {% endif %}
            {% for job in jobs.finished %}
                <tr>
                    <td>{{ job.id }}</td>
                    <td><span class="badge badge-info spider-name">{{ job.spider }}</span></td>
                    <td class="mm-time" data-utc="{{ job.start_time }}">{{ job.start_time }}</td>
                    <td class="mm-time" data-utc="{{ job.end_time }}">{{ job.end_time }}</td>
                    <td>{{ job.during|floatformat:-2 }}</td>
                    <td><a target="_blank" href="{{ log_url }}/{{ job.spider }}/{{ job.id }}.log">Logs</a></td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
        </table>
    </div>


{% endblock %}